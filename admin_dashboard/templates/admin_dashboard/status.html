{% extends 'base.html' %}

{% block title %}Etat du Systeme - Bijouterie Hafsa ERP{% endblock %}

{% block breadcrumb %}
    <span class="breadcrumb-separator">/</span>
    <a href="{% url 'admin_dashboard:home' %}" class="breadcrumb-item">Administration</a>
    <span class="breadcrumb-separator">/</span>
    <span class="breadcrumb-item active">Etat du Systeme</span>
{% endblock %}

{% block page_header %}
    <div class="page-header">
        <div class="page-header-inner">
            <div>
                <h1 class="page-title">Etat du Systeme</h1>
                <p class="page-subtitle">Diagnostics et sante generale du systeme</p>
            </div>
            <div class="page-actions">
                <a href="{% url 'admin_dashboard:home' %}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i>
                    <span>Retour</span>
                </a>
            </div>
        </div>
    </div>
{% endblock %}

{% block content %}
    <!-- System Status Overview -->
    <div class="status-grid mb-8 animate-stagger">
        <!-- Database Status -->
        <div class="card status-card">
            <div class="card-body">
                <div class="status-card-header">
                    <h3 class="status-card-title">Base de Donnees</h3>
                    <div class="status-icon success">
                        <i class="fas fa-database"></i>
                    </div>
                </div>
                <div class="status-details">
                    <div class="status-row">
                        <span class="status-label">Total Enregistrements</span>
                        <span class="status-value">{{ total_records }}</span>
                    </div>
                    <div class="status-row">
                        <span class="status-label">Statut</span>
                        <span class="badge badge-success"><i class="fas fa-check"></i> Normal</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Statistics -->
        <div class="card status-card">
            <div class="card-body">
                <div class="status-card-header">
                    <h3 class="status-card-title">Utilisateurs</h3>
                    <div class="status-icon info">
                        <i class="fas fa-users"></i>
                    </div>
                </div>
                <div class="status-details">
                    <div class="status-row">
                        <span class="status-label">Total Utilisateurs</span>
                        <span class="status-value">{{ total_users }}</span>
                    </div>
                    <div class="status-row">
                        <span class="status-label">Utilisateurs Actifs</span>
                        <span class="status-value text-success">{{ active_users }}</span>
                    </div>
                    <div class="status-row">
                        <span class="status-label">Administrateurs</span>
                        <span class="status-value">{{ admin_users }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Application Health Checks -->
    <div class="card mb-8 animate-slide-up">
        <div class="card-header">
            <h3><i class="fas fa-heartbeat mr-2"></i> Verifications de Sante</h3>
        </div>
        <div class="card-body" style="padding: 0;">
            <div class="health-list">
                <div class="health-item">
                    <span class="health-label">Django Application</span>
                    <span class="badge badge-success"><i class="fas fa-check"></i> Running</span>
                </div>
                <div class="health-item">
                    <span class="health-label">Database Connection</span>
                    <span class="badge badge-success"><i class="fas fa-check"></i> Connected</span>
                </div>
                <div class="health-item">
                    <span class="health-label">Static Files</span>
                    <span class="badge badge-success"><i class="fas fa-check"></i> OK</span>
                </div>
                <div class="health-item">
                    <span class="health-label">Media Files</span>
                    <span class="badge badge-success"><i class="fas fa-check"></i> OK</span>
                </div>
                <div class="health-item">
                    <span class="health-label">Email Configuration</span>
                    <span class="badge badge-success"><i class="fas fa-check"></i> Configured</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Statistics -->
    <div class="stats-row mb-8 animate-stagger">
        <div class="stat-card">
            <div class="stat-icon accent">
                <i class="fas fa-gem"></i>
            </div>
            <div class="stat-content">
                <div class="stat-label">Produits</div>
                <div class="stat-value">{{ total_products }}</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon primary">
                <i class="fas fa-user-tie"></i>
            </div>
            <div class="stat-content">
                <div class="stat-label">Clients</div>
                <div class="stat-value">{{ total_clients }}</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon info">
                <i class="fas fa-truck"></i>
            </div>
            <div class="stat-content">
                <div class="stat-label">Fournisseurs</div>
                <div class="stat-value">{{ total_suppliers }}</div>
            </div>
        </div>
    </div>

    <!-- System Information -->
    <div class="card mb-8 animate-slide-up">
        <div class="card-header">
            <h3><i class="fas fa-server mr-2"></i> Informations Systeme</h3>
        </div>
        <div class="card-body">
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Framework</span>
                    <span class="info-value">Django</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Base de Donnees</span>
                    <span class="info-value">PostgreSQL</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Environnement</span>
                    <span class="info-value">Production</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Support & Help -->
    <div class="alert alert-info animate-slide-up">
        <i class="fas fa-info-circle"></i>
        <div>
            <strong>Besoin d'Aide?</strong>
            <p style="margin-top: var(--space-1); font-size: var(--text-sm);">
                Si vous rencontrez des problemes ou avez des questions, veuillez contacter l'administrateur systeme.
            </p>
            <a href="{% url 'admin_dashboard:activity_log' %}" class="btn btn-secondary btn-sm" style="margin-top: var(--space-3);">
                <i class="fas fa-history"></i>
                <span>Consulter le journal d'activite</span>
            </a>
        </div>
    </div>

    <style>
        /* Status Grid */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-6);
        }

        .status-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-4);
        }

        .status-card-title {
            font-family: var(--font-display);
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--neutral-800);
        }

        .status-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-xl);
        }

        .status-icon.success {
            background: var(--success-50);
            color: var(--success-600);
        }

        .status-icon.info {
            background: var(--info-50);
            color: var(--info-600);
        }

        .status-details {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }

        .status-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-label {
            font-size: var(--text-sm);
            color: var(--neutral-600);
        }

        .status-value {
            font-weight: var(--font-semibold);
            color: var(--neutral-800);
        }

        .text-success {
            color: var(--success-600);
        }

        /* Health List */
        .health-list {
            display: flex;
            flex-direction: column;
        }

        .health-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-4);
            border-bottom: 1px solid var(--neutral-100);
        }

        .health-item:last-child {
            border-bottom: none;
        }

        .health-label {
            font-weight: var(--font-medium);
            color: var(--neutral-800);
        }

        /* Stats Row */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-4);
        }

        /* Info Grid */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-6);
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }

        .info-label {
            font-size: var(--text-sm);
            color: var(--neutral-500);
        }

        .info-value {
            font-weight: var(--font-semibold);
            color: var(--neutral-800);
        }

        /* Alert */
        .alert {
            display: flex;
            gap: var(--space-4);
            padding: var(--space-4);
            border-radius: var(--radius-md);
        }

        .alert-info {
            background: var(--info-50);
            color: var(--info-700);
            border: 1px solid var(--info-200);
        }

        .alert i:first-child {
            font-size: var(--text-xl);
            flex-shrink: 0;
        }

        /* Responsive */
        @media (max-width: 1023px) {
            .status-grid {
                grid-template-columns: 1fr;
            }

            .info-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .stats-row {
                grid-template-columns: repeat(2, 1fr);
            }

            .info-grid {
                grid-template-columns: 1fr;
            }

            .alert {
                flex-direction: column;
            }
        }
    </style>
{% endblock %}
